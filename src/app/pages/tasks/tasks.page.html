
  <ion-header [translucent]="true">
    <ion-toolbar>
      <ion-title>{{ 'tasks.title' | t }}</ion-title>
      <ion-buttons slot="end">
        <ion-button [routerLink]="['/tabs/history']" [queryParams]="{ section: 'tasks' }" fill="clear" color="medium">
          <ion-icon slot="icon-only" name="time-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-content [fullscreen]="true">
    <div class="tasks-shell">

      <ion-fab vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button color="primary" (click)="openForm()">
          <ion-icon name="add"></ion-icon>
        </ion-fab-button>
      </ion-fab>

      <section class="list-card">
        <div class="section-heading">
          <div>
        <p class="eyebrow">{{ 'tasks.section.eyebrow' | t }}</p>
        <strong>{{ 'tasks.section.heading' | t }}</strong>
          </div>
          <ion-badge color="medium">{{ openTasks.length }}</ion-badge>
        </div>

        <div *ngIf="!openTasks.length" class="empty-state">
          <ion-icon name="checkbox-outline"></ion-icon>
          <p>{{ 'tasks.list.empty.title' | t }}</p>
          <small>{{ 'tasks.list.empty.subtitle' | t }}</small>
        </div>

        <ion-list lines="none" *ngIf="openTasks.length">
          <ion-list-header>{{ 'tasks.list.header.open' | t }}</ion-list-header>
          <ion-item class="task-item" *ngFor="let task of openTasks">
            <ion-label>
              <div class="title-row">
                <ion-checkbox
                  [checked]="task.status === TaskStatus.COMPLETED"
                  (ionChange)="toggleCompletion(task, $event.detail.checked)">
                </ion-checkbox>
                <div class="title-block">
                  <strong>{{ task.title }}</strong>
                  <p class="description" *ngIf="task.description">{{ task.description }}</p>
                  <div class="meta-row">
                    <span class="meta-chip">
                      <ion-icon name="calendar-outline"></ion-icon>
                      {{ formatDate(task.dueDate) }}
                    </span>
                  </div>
                </div>
              </div>
            </ion-label>
            <ion-button
              slot="end"
              fill="clear"
              color="danger"
              size="small"
              (click)="deleteTask(task, $event)">
              <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
            </ion-button>
          </ion-item>
        </ion-list>
      </section>

    </div>
  </ion-content>
